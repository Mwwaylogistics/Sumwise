<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sumwise – AI Summaries</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f9fafb;
      margin: 0;
      padding: 0;
      text-align: center;
    }

    header {
      padding: 4rem 1rem 2rem;
    }

    h1 {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
    }

    p {
      color: #4b5563;
      margin-bottom: 1.5rem;
    }

    .button {
      background-color: #3b82f6;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      text-decoration: none;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }

    section {
      padding: 2rem 1rem;
    }

    .section-title {
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 1.5rem;
    }

    .card {
      background-color: white;
      margin: 0 auto 1rem;
      max-width: 500px;
      padding: 1rem;
      border-radius: 0.5rem;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      text-align: left;
    }

    .card strong {
      font-weight: bold;
    }

    footer {
      font-size: 0.875rem;
      color: #6b7280;
      padding: 2rem;
    }

    .recording-controls {
      margin: 1rem 0;
    }

    .recording-controls button {
      padding: 0.5rem 1rem;
      margin: 0 0.5rem;
      border-radius: 0.25rem;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }

    .recording-controls .start {
      background-color: #3b82f6;
      color: white;
    }

    .recording-controls .stop {
      background-color: #9ca3af;
      color: white;
    }

    #summary {
      background-color: #fff;
      margin: 1rem auto;
      max-width: 500px;
      padding: 1rem;
      border-radius: 0.5rem;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      min-height: 80px;
    }
  </style>
</head>
<body>

  <header>
    <h1>Sumwise</h1>
    <p>Turn voice notes into clear, AI-generated summaries — instantly.</p>
    <a class="button" href="#">Join the Waitlist</a>
  </header>

  <section style="background-color:#f3f4f6;">
    <h2 class="section-title">How It Works</h2>
    <div class="card"><strong>1.</strong> Upload or record audio.</div>
    <div class="card"><strong>2.</strong> AI transcribes and summarizes it.</div>
    <div class="card"><strong>3.</strong> Receive a clean, structured summary in seconds.</div>
  </section>

  <section>
    <h2 class="section-title">Pricing</h2>
    <div class="card"><strong>Free –</strong> Upload up to 3 audio notes per month.</div>
    <div class="card"><strong>Pro –</strong> $9/month for unlimited summaries and faster processing.</div>
  </section>

  <section>
    <h2 class="section-title">Try It Now</h2>
    <div class="card">
      <label><strong>Upload Audio</strong></label><br />
      <input type="file" id="fileInput" accept="audio/*" />
      <div class="recording-controls">
        <button class="start" id="startBtn">Start Recording</button>
        <button class="stop" id="stopBtn" disabled>Stop</button>
      </div>
      <div id="summary">AI-generated summary will appear here.</div>
    </div>
  </section>

  <footer>
    © 2025 Sumwise. All rights reserved.
  </footer>

  <script>
    let mediaRecorder;
    let audioChunks = [];

    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const fileInput = document.getElementById('fileInput');
    const summaryEl = document.getElementById('summary');

    startBtn.addEventListener('click', async () => {
      summaryEl.innerText = "Recording...";
      const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
      mediaRecorder = new MediaRecorder(stream);
      audioChunks = [];

      mediaRecorder.addEventListener("dataavailable", event => {
        audioChunks.push(event.data);
      });

      mediaRecorder.addEventListener("stop", () => {
        const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
        sendAudio(audioBlob);
      });

      mediaRecorder.start();
      startBtn.disabled = true;
      stopBtn.disabled = false;
    });

    stopBtn.addEventListener('click', () => {
      mediaRecorder.stop();
      startBtn.disabled = false;
      stopBtn.disabled = true;
    });

    fileInput.addEventListener('change', () => {
      const file = fileInput.files[0];
      if (file) {
        sendAudio(file);
      }
    });

    async function sendAudio(audioBlob) {
      summaryEl.innerText = "Processing...";
      try {
        const response = await fetch('/api/transcribe', {
          method: 'POST',
          body: audioBlob
        });

        const data = await response.json();
        summaryEl.innerText = data.summary || 'No summary returned.';
      } catch (err) {
        console.error(err);
        summaryEl.innerText = 'Error: ' + err.message;
      }
    }
  </script>
</body>
</html>
